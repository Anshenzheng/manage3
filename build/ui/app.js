/**
 * Manage System v3.0 | haovei@qq.com
 */
define("main/controllers",["main/init"],function(){function e(e){e.mainStatus={navFold:document.body.clientWidth<1500,navigation:"",msgBubble:0},e.pageTo=function(e){window.location.assign(e)},$.getJSON(Config.getMainInfo,function(t){200==t.code&&angular.extend(e.mainStatus,t.data)}).complete(function(){e.$digest()}),$(document).on("click",".top-nav-wrap .backBtn",function(){window.history.back()})}function t(){}function a(e){}function n(e,t){t.close()}e.$inject=["$scope"],a.$inject=["$scope"],n.$inject=["$scope","modal"],angular.module("manageApp.main").controller("mainCtrl",e).controller("oneCtrl",t).controller("sideNav",a).controller("pageCtrl",n)}),define("main/directives",["main/init"],function(){function e(e,t){return{restrict:"A",priority:-500,link:function(a,n){t.remove(e.current.loadedTemplateUrl)}}}function t(e){var t=e("date");return{require:"ngModel",link:function(e,a,n,i){var l=n.convertToDate?n.convertToDate:"yyyy-MM-dd";i.$parsers.push(function(e){return t(e,l)}),i.$formatters.push(function(){return i.$modelValue})}}}function a(){return{require:"ngModel",link:function(e,t,a,n){n.$parsers.push(function(e){return parseInt(e,10)}),n.$formatters.push(function(e){return""+e})}}}function n(e,t){return{restrict:"AE",scope:!0,transclude:!0,link:function(a,n,i,l,o){function r(n){a.isLoading=!0,e({method:"POST",url:i.detailsInfo,data:n,transformRequest:function(e){return t(e)},headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){a.isLoading=!1,200==e.code&&(a.detailsHandler?a.details=a.detailsHandler(e.data):a.details=e.data)}).error(function(){a.isLoading=!1})}a.isLoading=!1,o(a,function(e){n.append(e)}),a.detailsHandler=a.$eval(i.detailsHandler),i.$observe("detailsParams",function(e){r(a.$eval(e))}),i.detailsParams||r({})}}}function i(e,t){return{restrict:"A",scope:!0,link:function(a,n,i){var l=a.formStatus={submitted:!1,submitting:!1,submitInfo:""},o=angular.element(n)[0];a.$eval(i.name);a.reset=function(){o.reset()},n.on("submit",function(n){n.preventDefault(),l.submitting=!0,e({method:"POST",url:i.action,data:a.formData,transformRequest:function(e){return t(e)},headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){l.submitting=!1,200==e.code?(l.submitInfo=e.message||"提交成功",angular.isFunction(a.submitCallBack)?a.submitCallBack(e):e.url&&window.location.assign(e.options.url)):(l.submitInfo=e.message||"提交错误",angular.isFunction(a.submitCallBack)&&a.submitCallBack(e))}).error(function(){l.submitting=!1,l.submitInfo="提交失败。"})})}}}function l(e,t,a){return{restrict:"AE",scope:{listParams:"=",listSelected:"=",listSource:"="},transclude:!0,require:"?^ngModel",link:function(n,i,l,o,r){function s(e){return l.listSource?(n.tbodyList=n.listSource,void(e&&e())):(d.isLoading=!0,void $.getJSON(n.listData,angular.merge({},g,{page:d.currentPage}),function(e,t,a,i){200==e.code?(e.options&&(d.totalCount=e.options.totalCount||d.totalCount,d.pageSize=e.options.pageSize||d.pageSize,d.totalPage=Math.ceil(d.totalCount/d.pageSize)),e.data&&e.data.length>0?n.tbodyList=e.data:d.isFinished=!0,d.loadFailMsg=e.message):(d.isFinished=!0,d.loadFailMsg=e.message),d.isLoading=!1}).error(function(){d.isLoading=!1,d.loadFailMsg="加载出错"}).complete(function(){e&&e(),n.$digest(),u()}))}function c(){var e=[];n.listSelected.length=0,$(".selectOne:checked",i).each(function(){e.push(this.value)}),[].unshift.apply(n.listSelected,e);var t=[];angular.forEach(n.tbodyList,function(e){angular.forEach(n.listSelected,function(a){e.id==a&&t.push(e)})}),o&&o.$setViewValue(t)}function u(){$(".selectOne",i).on("click",function(e){e.stopPropagation();var t=$(".selectOne",i).length,a=$(".selectOne:checked",i).length;a>0&&t>a?$(".selectAll",i).prop("checked",!1).get(0).indeterminate=!0:t==a?$(".selectAll",i).prop("checked",!0).get(0).indeterminate=!1:$(".selectAll",i).prop("checked",!1).get(0).indeterminate=!1,c(),n.$apply()})}var d={currentPage:1,totalCount:0,pageSize:10,totalPage:1,isFinished:!1,isLoading:!1};n.parent=n.$parent,n.status=d,n.listData=l.listData,n.theadList=angular.fromJson(l.listThead),n.tbodyList=[],n.getListData=s,angular.isDefined(n.listParams)||(n.listParams={}),angular.isDefined(n.listSelected)||(n.listSelected=[]),n.delSelected=function(e){t("确定删除这些?",function(){$.post(e,{ids:n.listSelected.join(",")},function(e){200==e.code?n.$broadcast("reloadList"):alert(e.message||"删除错误")},"json").error(function(){alert("请求错误")})})},n.submitCallBack=function(t){200==t.code&&(e.closeAll(),a(function(){n.$broadcast("reloadList")}))};var g={};n.$on("deleteSelected",function(e,t){$(".selectOne[value="+t.id+"]",i).prop("checked",!1);var a=$(".selectOne",i).length,l=$(".selectOne:checked",i).length;l>0&&a>l?$(".selectAll",i).prop("checked",!1).get(0).indeterminate=!0:a==l?$(".selectAll",i).prop("checked",!0).get(0).indeterminate=!1:$(".selectAll",i).prop("checked",!1).get(0).indeterminate=!1;var o=[];n.listSelected.length=0,$(".selectOne:checked",i).each(function(){o.push(this.value)}),[].unshift.apply(n.listSelected,o),c()}),n.$watchCollection("listSource",function(e){e&&s(c)}),n.$watch("listParams",function(){d.currentPage=1,d.isFinished=!1,n.tbodyList=[],g=angular.copy(n.listParams),s(c),$(".selectAll",i).length>0&&($(".selectAll",i).prop("checked",!1).get(0).indeterminate=!1)},!0),n.$on("reloadList",function(){d.currentPage=1,d.isFinished=!1,n.tbodyList=[],g=angular.copy(n.listParams),s(c),$(".selectAll",i).length>0&&($(".selectAll",i).prop("checked",!1).get(0).indeterminate=!1)}),$(i).on("click",".selectAll",function(){this.indeterminate?(this.checked=!1,$(".selectOne",i).prop("checked",!1)):$(".selectOne",i).prop("checked",this.checked),c(),n.$apply()}),r(n,function(e){i.append(e)})}}}function o(){return{restrict:"AE",scope:{row:"="},replace:!0,templateUrl:"tpl/table-cell.html",link:function(e,t,a){e.cells=[],angular.isString(e.row)||angular.isNumber(e.row)?e.cells.push({text:e.row}):angular.isArray(e.row)?angular.forEach(e.row,function(t){angular.isObject(t)?e.cells.push(t):e.cells.push({text:t})}):e.cells.push(e.row)}}}function r(){return{restrict:"AE",scope:!0,replace:!0,templateUrl:"tpl/pagination.html",link:function(e,t,a){function n(e,t,a){return{number:e,text:t,active:a}}function i(e,t){var a=[],i=1,r=t,s=angular.isDefined(l)&&t>l;s&&(o?(i=Math.max(e-Math.floor(l/2),1),r=i+l-1,r>t&&(r=t,i=r-l+1)):(i=(Math.ceil(e/l)-1)*l+1,r=Math.min(i+l-1,t)));for(var c=i;r>=c;c++){var u=n(c,c,c===e);a.push(u)}if(s&&!o){if(i>1){var d=n(i-1,"...",!1);a.unshift(d)}if(t>r){var g=n(r+1,"...",!1);a.push(g)}}return a}var l=angular.isDefined(a.maxSize)?e.$parent.$eval(a.maxSize):10,o=angular.isDefined(a.rotate)?e.$parent.$eval(a.rotate):!0;e.start=function(){1!=e.status.currentPage&&(e.status.currentPage=1,e.getListData())},e.prev=function(){e.status.currentPage<=1||(e.status.currentPage--,e.getListData())},e.next=function(){e.status.currentPage>=e.status.totalPage||(e.status.currentPage++,e.getListData())},e.end=function(){e.status.currentPage!=e.status.totalPage&&(e.status.currentPage=e.status.totalPage,e.getListData())},e["goto"]=function(t){e.status.currentPage=t,e.getListData()},e.$watch("status.totalPage",function(){e.pages=i(e.status.currentPage,e.status.totalPage)}),e.$watch("status.currentPage",function(){e.pages=i(e.status.currentPage,e.status.totalPage)})}}}function s(){return{restrict:"AE",scope:!0,replace:!0,templateUrl:"tpl/pagination2.html",link:function(e,t,a){e.start=function(){1!=e.status.currentPage&&(e.status.currentPage=1,e.getListData())},e.prev=function(){e.status.currentPage<=1||(e.status.currentPage--,e.getListData())},e.next=function(){e.status.currentPage>=e.status.totalPage||(e.status.currentPage++,e.getListData())},e.end=function(){e.status.currentPage!=e.status.totalPage&&(e.status.currentPage=e.status.totalPage,e.getListData())}}}}function c(){return{restrict:"AE",scope:!0,transclude:!0,link:function(e,t,a,n,i){function l(){angular.extend(e.listParams,{area:o.area?o.area.id:void 0,building:o.building?o.building.id:void 0,house:o.house?o.house.id:void 0,sale:o.sale?o.sale.id:void 0,room:o.room?o.room.id:void 0})}var o=e.filterConditions={list:[]};e.conditionList={},e.selectArea=function(e){e.type="area",o.area=e,o.list.push(e),l()},e.selectBuilding=function(e){e.type="building",o.building=e,o.list.push(e),l()},e.selectHouse=function(e){e.type="house",o.house=e,o.list.push(e),l()},e.selectSale=function(e){e.type="sale",o.sale=e,o.list.push(e),l()},e.selectRoom=function(e){var t={id:e,name:"房间号:"+e,type:"room"};o.room=t,o.list.push(t),l()},e.deleteCondition=function(e){var t=o.list.indexOf(e);o.list.splice(t,1),delete o[e.type],l()},function(){$.getJSON(a.filterConditions,{},function(t){200==t.code&&(e.conditionList=t.data)}).complete(function(){e.$digest()})}(),i(e,function(e){t.append(e)})}}}function u(e,t){return{restrict:"AE",scope:{},require:"?^ngModel",templateUrl:"tpl/tree.html",link:function(a,n,i,l){a.status={},a.treeList=[],a.curTree1={},a.curTree2={},a.curTree3={},a.status.isLoading=!0,a.selectTree1=function(e){a.curTree1=e},a.selectTree2=function(e){a.curTree2=e;var n=t("filter")(a.treeList,{pid:e.id},e);if(n.length<1){var i=angular.copy(e);i.p=a.curTree1,l&&l.$setViewValue(i)}},a.selectTree3=function(e){a.curTree3=e;var t=angular.copy(e);t.p=a.curTree2,t.p2=a.curTree1,l&&l.$setViewValue(t)},e({method:"POST",url:i.treeList}).success(function(e,t,n,i){200==e.code&&(a.treeList=e.data),a.status.isLoading=!1}).error(function(){a.status.isLoading=!1})}}}function d(e,t){return{restrict:"AE",scope:!0,transclude:!0,require:"?^ngModel",link:function(a,n,i,l,o){function r(n){return i.listSource?(a.tbodyList=a.listSource,void(n&&n())):(s.isLoading=!0,void e({method:"POST",url:i.navList,transformRequest:function(e){return t(e)},headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,n,i){a.isLoading=!1,200==e.code&&(a.listData=e.data,a.select(a.listData[0]))}).error(function(){a.isLoading=!1}))}o(a,function(e){n.append(e)});var s={isLoading:!0};a.status=s,a.currentSelect={};a.select=function(e){a.currentSelect=e,l&&l.$setViewValue(e)},r()}}}function g(){return{restrict:"A",scope:{},require:"?^ngModel",link:function(e,t,a,n){$.post(a.selectAsync,{},function(e){if(200==e.status){for(var a='<option value="">请选择</option>',i=e.data.length,l=0;i>l;l++)a+='<option value="'+e.data[l].value+'"'+(n.$viewValue==e.data[l].value?"selected":"")+">"+e.data[l].text+"</option>";t.html(a)}},"json").complete(function(){e.$digest()})}}}function p(e){return{restrict:"A",scope:{},link:function(t,a,n){function i(e){$.post(o,e,function(e){if(200==e.status){for(var t=r?"":'<option value="">请选择</option>',n=e.data.length,i=0;n>i;i++)t+="<option "+(0===e.data[i].enabled?' class="text-muted"':"")+' value="'+e.data[i].value+'" '+(e.data[i].selected||r&&0==i?"selected":"")+">"+e.data[i].text+"</option>";a.html(t),a.trigger("change")}},"json")}var l=n.relativeTo,o=n.relativeSelect,r=angular.isDefined(n.selectFirst);a.on("change",function(){var e={};e[this.name]=this.value,$(l).trigger("update",e)}),a.on("update",function(e,t){i(t)}),n.relativeInitload&&e(function(){a.trigger("change")})}}}e.$inject=["$route","$templateCache"],t.$inject=["$filter"],a.$inject=[],n.$inject=["$http","$httpParamSerializer"],i.$inject=["$http","$httpParamSerializer"],l.$inject=["modal","dialogConfirm","$timeout"],u.$inject=["$http","$filter"],d.$inject=["$http","$httpParamSerializer"],g.$inject=[],p.$inject=["$timeout"],angular.module("manageApp.main").directive("ngView",e).directive("convertToDate",t).directive("convertToNumber",a).directive("detailsInfo",n).directive("formValidator",i).directive("tableList",l).directive("tableCell",o).directive("pagination",r).directive("pagination2",s).directive("filterConditions",c).directive("treeList",u).directive("navList",d).directive("selectAsync",g).directive("relativeSelect",p)}),define("main/filters",["main/init"],function(){angular.module("manageApp.main")}),define("main/init",["angular"],function(){angular.module("manageApp.main",[])}),define("main/services",["main/init"],function(){function e(e,t){return function(a,n){var i=e.$new(!1);i.confirmText="确定删除?",t.openConfirm({template:"tpl/dialog-confirm.html",scope:i}).then(n)}}e.$inject=["$rootScope","modal"],angular.module("manageApp.main").service("dialogConfirm",e)}),define("modal/directives",["modal/init"],function(){function e(e){return{restrict:"A",scope:{modalScope:"="},link:function(t,a,n){a.on("click",function(a){a.preventDefault();var i=angular.isDefined(t.modalScope)?t.modalScope:"noScope";angular.isDefined(n.ngDialogClosePrevious)&&e.close(n.ngDialogClosePrevious);var l=e.getDefaults();e.open({template:n.ngDialog,className:n.ngDialogClass||l.className,controller:n.ngDialogController,controllerAs:n.ngDialogControllerAs,bindToController:n.ngDialogBindToController,scope:i,data:n.ngDialogData,showClose:"false"===n.ngDialogShowClose?!1:"true"===n.ngDialogShowClose?!0:l.showClose,closeByDocument:"false"===n.ngDialogCloseByDocument?!1:"true"===n.ngDialogCloseByDocument?!0:l.closeByDocument,closeByEscape:"false"===n.ngDialogCloseByEscape?!1:"true"===n.ngDialogCloseByEscape?!0:l.closeByEscape,overlay:"false"===n.ngDialogOverlay?!1:"true"===n.ngDialogOverlay?!0:l.overlay,preCloseCallback:n.ngDialogPreCloseCallback||l.preCloseCallback})})}}}function t(e){return{restrict:"A",scope:{modalScope:"="},link:function(t,a,n){var i=n.modalRight||"50%";a.on("click",function(a){a.preventDefault(),e.close(),e.open({template:n.modalUrl,className:"ngdialog-theme-right",cache:!1,trapFocus:!1,overlay:!1,data:n.modalData,scope:t.modalScope,controller:["$scope","$element",function(e,t){$(".ngdialog-content",t).width(i)}]})})}}}function a(e){return{restrict:"A",scope:{modalScope:"="},link:function(t,a,n){var i=n.modalCenter||"50%";a.on("click",function(a){a.preventDefault(),e.open({template:n.modalUrl,cache:!1,trapFocus:!1,data:n.modalData,scope:t.modalScope,controller:["$scope","$element",function(e,t){$(".ngdialog-content",t).width(i)}]})})}}}e.$inject=["modal"],t.$inject=["modal"],a.$inject=["modal"],angular.module("manageApp.modal").directive("modal",e).directive("modalRight",t).directive("modalCenter",a)}),define("modal/init",["angular"],function(){angular.module("manageApp.modal",[])}),define("modal/services",["modal/init"],function(){"use strict";var e=angular.module("manageApp.modal"),t=angular.element,a=angular.isDefined,n=(document.body||document.documentElement).style,i=a(n.animation)||a(n.WebkitAnimation)||a(n.MozAnimation)||a(n.MsAnimation)||a(n.OAnimation),l="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",o="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",r="ngdialog-disabled-animation",s={html:!1,body:!1},c={},u=[],d=!1;e.provider("modal",function(){var e=this.defaults={className:"ngdialog-theme-default",disableAnimation:!1,plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0,trapFocus:!0,preserveFocus:!0,ariaAuto:!0,ariaRole:null,ariaLabelledById:null,ariaLabelledBySelector:null,ariaDescribedById:null,ariaDescribedBySelector:null};this.setForceHtmlReload=function(e){s.html=e||!1},this.setForceBodyReload=function(e){s.body=e||!1},this.setDefaults=function(t){angular.extend(e,t)};var a,n=0,g=0,p={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function(f,m,v,h,b,y,$,D,C,A){var k=[],P={onDocumentKeydown:function(e){27===e.keyCode&&L.close("$escape")},activate:function(e){var t=e.data("$ngDialogOptions");t.trapFocus&&(e.on("keydown",P.onTrapFocusKeydown),k.body.on("keydown",P.onTrapFocusKeydown))},deactivate:function(e){e.off("keydown",P.onTrapFocusKeydown),k.body.off("keydown",P.onTrapFocusKeydown)},deactivateAll:function(e){angular.forEach(e,function(e){var t=angular.element(e);P.deactivate(t)})},setBodyPadding:function(e){var t=parseInt(k.body.css("padding-right")||0,10);k.body.css("padding-right",t+e+"px"),k.body.data("ng-dialog-original-padding",t),y.$broadcast("ngDialog.setPadding",e)},resetBodyPadding:function(){var e=k.body.data("ng-dialog-original-padding");e?k.body.css("padding-right",e+"px"):k.body.css("padding-right",""),y.$broadcast("ngDialog.setPadding",0)},performCloseDialog:function(e,t){var n=e.data("$ngDialogOptions"),o=e.attr("id"),r=c[o];if(r){if("undefined"!=typeof D.Hammer){var s=r.hammerTime;s.off("tap",a),s.destroy&&s.destroy(),delete r.hammerTime}else e.unbind("click");1===g&&k.body.unbind("keydown",P.onDocumentKeydown),e.hasClass("ngdialog-closing")||(g-=1);var f=e.data("$ngDialogPreviousFocus");f&&f.focus&&f.focus(),y.$broadcast("ngDialog.closing",e,t),g=0>g?0:g,i&&!n.disableAnimation?(r.$destroy(),e.unbind(l).bind(l,function(){P.closeDialogElement(e,t)}).addClass("ngdialog-closing")):(r.$destroy(),P.closeDialogElement(e,t)),p[o]&&(p[o].resolve({id:o,value:t,$dialog:e,remainingDialogs:g}),delete p[o]),c[o]&&delete c[o],u.splice(u.indexOf(o),1),u.length||(k.body.unbind("keydown",P.onDocumentKeydown),d=!1)}},closeDialogElement:function(e,t){e.remove(),0===g&&(k.html.removeClass("ngdialog-open"),k.body.removeClass("ngdialog-open"),P.resetBodyPadding()),y.$broadcast("ngDialog.closed",e,t)},closeDialog:function(e,t){var a=e.data("$ngDialogPreCloseCallback");if(a&&angular.isFunction(a)){var n=a.call(e,t);angular.isObject(n)?n.closePromise?n.closePromise.then(function(){P.performCloseDialog(e,t)}):n.then(function(){P.performCloseDialog(e,t)},function(){}):n!==!1&&P.performCloseDialog(e,t)}else P.performCloseDialog(e,t)},onTrapFocusKeydown:function(e){var t,a=angular.element(e.currentTarget);if(a.hasClass("ngdialog"))t=a;else if(t=P.getActiveDialog(),null===t)return;var n=9===e.keyCode,i=e.shiftKey===!0;n&&P.handleTab(t,e,i)},handleTab:function(e,t,a){var n=P.getFocusableElements(e);if(0===n.length)return void(document.activeElement&&document.activeElement.blur());var i=document.activeElement,l=Array.prototype.indexOf.call(n,i),o=-1===l,r=0===l,s=l===n.length-1,c=!1;a?(o||r)&&(n[n.length-1].focus(),c=!0):(o||s)&&(n[0].focus(),c=!0),c&&(t.preventDefault(),t.stopPropagation())},autoFocus:function(e){var a=e[0],n=a.querySelector("*[autofocus]");if(null===n||(n.focus(),document.activeElement!==n)){var i=P.getFocusableElements(e);if(i.length>0)return void i[0].focus();var l=P.filterVisibleElements(a.querySelectorAll("h1,h2,h3,h4,h5,h6,p,span"));if(l.length>0){var o=l[0];t(o).attr("tabindex","-1").css("outline","0"),o.focus()}}},getFocusableElements:function(e){var t=e[0],a=t.querySelectorAll(o),n=P.filterTabbableElements(a);return P.filterVisibleElements(n)},filterTabbableElements:function(e){for(var a=[],n=0;n<e.length;n++){var i=e[n];"-1"!==t(i).attr("tabindex")&&a.push(i)}return a},filterVisibleElements:function(e){for(var t=[],a=0;a<e.length;a++){var n=e[a];(n.offsetWidth>0||n.offsetHeight>0)&&t.push(n)}return t},getActiveDialog:function(){var e=document.querySelectorAll(".ngdialog");return 0===e.length?null:t(e[e.length-1])},applyAriaAttributes:function(e,t){if(t.ariaAuto){if(!t.ariaRole){var a=P.getFocusableElements(e).length>0?"dialog":"alertdialog";t.ariaRole=a}t.ariaLabelledBySelector||(t.ariaLabelledBySelector="h1,h2,h3,h4,h5,h6"),t.ariaDescribedBySelector||(t.ariaDescribedBySelector="article,section,p")}t.ariaRole&&e.attr("role",t.ariaRole),P.applyAriaAttribute(e,"aria-labelledby",t.ariaLabelledById,t.ariaLabelledBySelector),P.applyAriaAttribute(e,"aria-describedby",t.ariaDescribedById,t.ariaDescribedBySelector)},applyAriaAttribute:function(e,a,n,i){if(n&&e.attr(a,n),i){var l=e.attr("id"),o=e[0].querySelector(i);if(!o)return;var r=l+"-"+a;return t(o).attr("id",r),e.attr(a,r),r}},detectUIRouter:function(){try{return angular.module("ui.router"),!0}catch(e){return!1}},getRouterLocationEventName:function(){return P.detectUIRouter()?"$stateChangeSuccess":"$locationChangeSuccess"}},L={__PRIVATE__:P,open:function(i){function l(e,t){return y.$broadcast("ngDialog.templateLoading",e),b.get(e,t||{}).then(function(t){return y.$broadcast("ngDialog.templateLoaded",e),t.data||""})}function o(e){return e?angular.isString(e)&&s.plain?e:"boolean"!=typeof s.cache||s.cache?l(e,{cache:m}):l(e,{cache:!1}):"Empty template"}var s=angular.copy(e),f=++n,S="ngdialog"+f;u.push(S),i=i||{},angular.extend(s,i);var w;p[S]=w=h.defer();var T;c[S]=T=angular.isObject(s.scope)?s.scope.$new():y.$new();var x,E,B=angular.extend({},s.resolve);return angular.forEach(B,function(e,t){B[t]=angular.isString(e)?A.get(e):A.invoke(e,null,null,t)}),h.all({template:o(s.template||s.templateUrl),locals:h.all(B)}).then(function(e){var n=e.template,i=e.locals;s.showClose&&(n+='<div class="ngdialog-close"></div>');var l=s.overlay?"":" ngdialog-no-overlay";if(x=t('<div id="ngdialog'+f+'" class="ngdialog'+l+'"></div>'),x.html(s.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content" role="document">'+n+"</div>":'<div class="ngdialog-content" role="document">'+n+"</div>"),x.data("$ngDialogOptions",s),T.ngDialogId=S,s.data&&angular.isString(s.data)){var o=s.data.replace(/^\s*/,"")[0];T.ngDialogData="{"===o||"["===o?angular.fromJson(s.data):s.data}else s.data&&angular.isObject(s.data)&&(T.ngDialogData=s.data);if(s.className&&x.addClass(s.className),s.disableAnimation&&x.addClass(r),E=s.appendTo&&angular.isString(s.appendTo)?angular.element(document.querySelector(s.appendTo)):k.body,P.applyAriaAttributes(x,s),s.preCloseCallback){var c;angular.isFunction(s.preCloseCallback)?c=s.preCloseCallback:angular.isString(s.preCloseCallback)&&T&&(angular.isFunction(T[s.preCloseCallback])?c=T[s.preCloseCallback]:T.$parent&&angular.isFunction(T.$parent[s.preCloseCallback])?c=T.$parent[s.preCloseCallback]:y&&angular.isFunction(y[s.preCloseCallback])&&(c=y[s.preCloseCallback])),c&&x.data("$ngDialogPreCloseCallback",c)}if(T.closeThisDialog=function(e){P.closeDialog(x,e)},s.controller&&(angular.isString(s.controller)||angular.isArray(s.controller)||angular.isFunction(s.controller))){var u;s.controllerAs&&angular.isString(s.controllerAs)&&(u=s.controllerAs);var p=C(s.controller,angular.extend(i,{$scope:T,$element:x}),!0,u);s.bindToController&&angular.extend(p.instance,{ngDialogId:T.ngDialogId,ngDialogData:T.ngDialogData,closeThisDialog:T.closeThisDialog}),x.data("$ngDialogControllerController",p())}if($(function(){var e=document.querySelectorAll(".ngdialog");P.deactivateAll(e),v(x)(T);var t=D.innerWidth-k.body.prop("clientWidth");k.html.addClass("ngdialog-open"),k.body.addClass("ngdialog-open");var a=t-(D.innerWidth-k.body.prop("clientWidth"));a>0&&P.setBodyPadding(a),E.append(x),P.activate(x),s.trapFocus&&P.autoFocus(x),s.name?y.$broadcast("ngDialog.opened",{dialog:x,name:s.name}):y.$broadcast("ngDialog.opened",x)}),d||(k.body.bind("keydown",P.onDocumentKeydown),d=!0),s.closeByNavigation){var m=P.getRouterLocationEventName();y.$on(m,function(){P.closeDialog(x)})}if(s.preserveFocus&&x.data("$ngDialogPreviousFocus",document.activeElement),a=function(e){var a=s.closeByDocument?t(e.target).hasClass("ngdialog-overlay"):!1,n=t(e.target).hasClass("ngdialog-close");(a||n)&&L.close(x.attr("id"),n?"$closeButton":"$document")},"undefined"!=typeof D.Hammer){var h=T.hammerTime=D.Hammer(x[0]);h.on("tap",a)}else x.bind("click",a);return g+=1,L}),{id:S,closePromise:w.promise,close:function(e){P.closeDialog(x,e)}}},openConfirm:function(a){var n=h.defer(),i=angular.copy(e);a=a||{},angular.extend(i,a),i.scope=angular.isObject(i.scope)?i.scope.$new():y.$new(),i.scope.confirm=function(e){n.resolve(e);var a=t(document.getElementById(l.id));P.performCloseDialog(a,e)};var l=L.open(i);return l.closePromise.then(function(e){return e?n.reject(e.value):n.reject()}),n.promise},isOpen:function(e){var a=t(document.getElementById(e));return a.length>0},close:function(e,a){var n=t(document.getElementById(e));if(n.length)P.closeDialog(n,a);else if("$escape"===e){var i=u[u.length-1];n=t(document.getElementById(i)),n.data("$ngDialogOptions").closeByEscape&&P.closeDialog(n,"$escape")}else L.closeAll(a);return L},closeAll:function(e){for(var a=document.querySelectorAll(".ngdialog"),n=a.length-1;n>=0;n--){var i=a[n];P.closeDialog(t(i),e)}},getOpenDialogs:function(){return u},getDefaults:function(){return e}};return angular.forEach(["html","body"],function(e){if(k[e]=f.find(e),s[e]){var t=P.getRouterLocationEventName();y.$on(t,function(){k[e]=f.find(e)})}}),L}]})}),define("upload/directives",["upload/init"],function(){function e(){return{restrict:"EA",scope:{ngModel:"="},replace:!0,templateUrl:"tpl/uploader.html",link:function(e,t,a){function n(){for(var t=o[0].files,a=0,n=t.length;n>a;a++)if(/image/g.test(t[a].type)){var i={status:"uploading",file:t[a],progress:0,text:"上传中...",data:{},imgSrc:window.URL.createObjectURL(new Blob([t[a]],{type:t[a].type}))};e.fileList.push(i),e.$digest(),l(i)}else alert("只能上传图片")}function i(t){var a=[];angular.forEach(e.fileList,function(n,i){t==n?e.fileList.splice(i,1):a.push(n.data.id)}),e.ngModel=a}function l(t){var n=new XMLHttpRequest,i=new FormData;i.append("fileData",t.file),n.upload.addEventListener("progress",function(a){t.progress=Math.round(100*a.loaded/a.total),e.$digest()},!1),n.addEventListener("load",function(a){var n=angular.fromJson(a.target.responseText);t.progress=100,t.status="finished",t.text="上传成功！",t.data=n.data,e.ngModel.push(n.data.id),e.$apply()},!1),n.addEventListener("loadend",function(a){200!=a.target.status&&(t.status="error",t.text="上传失败！",e.$apply())}),n.open("POST",a.uploader),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(i)}var o=$('<input type="file" multiple/>');e.fileList=[],e.delFile=i,e.ngModel=e.ngModel||[],e.$parent.resetPic=function(){e.ngModel=[],e.fileList=[]},$(".uploadBtn",t).on("click",function(){o.trigger("click")}),o.on("change",n)}}}e.$inject=[],angular.module("manageApp.upload").directive("uploader",e)}),define("upload/init",["angular"],function(){angular.module("manageApp.upload",[])}),define("manageApp.template",["angular"],function(){!function(){"use strict";angular.module("manageApp.template",[]).run(["$templateCache",function(e){e.put("tpl/config-floor.html",'<table class="table-list"><tbody><tr><td>单元名称</td><td ng-repeat="unit in config.unitList track by $index"><input type="text" class="ipt ipt-s ipt-xshort" ng-model="config.unitList[$index]"></td></tr><tr><td>每层户数</td><td ng-repeat="col in config.unitColList track by $index"><input type="number" class="ipt ipt-s ipt-xshort" min="1" ng-model="config.unitColList[$index]"></td></tr></tbody></table>'),e.put("tpl/dialog-confirm.html",'<div class="page-dialog-wrap"><div class="page-dialog-content"><div class="mgb-l">{{confirmText}}</div><div class="text-center pd-v-s"><button type="button" class="btn btn-gray" ng-click="closeThisDialog()">取消</button> <button type="button" class="btn btn-blue" ng-click="confirm()">确定</button></div></div></div>'),e.put("tpl/dialog-tree.html",'<div class="page-dialog-wrap"><div class="page-dialog-title">选择</div><div class="page-dialog-content"><div class="tree-list tree-list-border" tree-list="../data/tree.data" ng-model="selectItem"></div><div class="text-center pd-v-s"><button type="button" class="btn btn-gray" ng-click="closeThisDialog()">取消</button> <button type="button" class="btn btn-blue" ng-click="confirm(selectItem)">确定</button></div></div></div>'),e.put("tpl/pagination.html",'<ul class="pagination" ng-if="status.totalPage>1"><li ng-class="{disabled:status.currentPage==1}"><a ng-click="prev()"><span>«</span></a></li><li ng-repeat="page in pages" ng-class="{active:page.active}"><a ng-click="goto(page.number)">{{page.text}}</a></li><li ng-class="{disabled:status.currentPage==status.totalPage}"><a ng-click="next()"><span>»</span></a></li></ul>'),e.put("tpl/pagination2.html",'<ul class="pagination2" ng-if="status.totalPage!=1"><li class="text-muted">{{status.currentPage+"/" + status.totalPage}} 页</li><li><a ng-class="{\'on\':status.currentPage==1}" ng-click="start()"><i class="iconfont icon-page-start"></i></a></li><li><a ng-class="{\'on\':status.currentPage==1}" ng-click="prev()"><i class="iconfont icon-page-prev"></i></a></li><li><a ng-class="{\'on\':status.currentPage==status.totalPage}" ng-click="next()"><i class="iconfont icon-page-next"></i></a></li><li><a ng-class="{\'on\':status.currentPage==status.totalPage}" ng-click="end()"><i class="iconfont icon-page-end"></i></a></li></ul>'),e.put("tpl/table-cell.html",'<span ng-repeat="cell in cells" class="{{cell.css}}">{{cell.text}}</span>'),e.put("tpl/table-list.html",'<div><div class="fr"><pagination status="status"></pagination></div><div ng-transclude=""></div></div><table class="table-list"><thead><tr><th ng-if="listSelected"><input type="checkbox" class="selectAll"></th><th ng-repeat="(hKey,hValue) in theadList">{{hValue}}</th></tr></thead><tbody><tr ng-repeat="tr in tbodyList"><td ng-if="listSelected" class="select-td"><input type="checkbox" class="selectOne" value="{{tr.id}}">{{$index}}</td><td ng-repeat="(hKey,hValue) in theadList"><table-cell row="tr[hKey]"></table-cell></td></tr></tbody></table>'),e.put("tpl/tree.html",'<div class="loader" ng-if="status.isLoading"><div class="loader-inner pacman"><div></div><div></div><div></div><div></div><div></div></div></div><div ng-if="!status.isLoading"><div class="empty-wrap" ng-if="treeList.length==0"><div class="icon"><i class="iconfont icon-empty"></i></div><div>什么也没有</div></div><ul ng-if="treeList.length"><li ng-class="{fold:curTree1.id==tree.id}" ng-repeat="tree in treeList | filter:{pid:0}:true"><em ng-click="selectTree1(tree)"><i class="iconfont fold-p"></i> {{tree.name}}</em><ul><li ng-class="{fold:curTree2.id==tree2.id}" ng-repeat="tree2 in treeList | filter:{pid:tree.id}:true"><em ng-click="selectTree2(tree2)"><i class="iconfont fold-p"></i> {{tree2.name}}</em><ul><li ng-class="{on:curTree3.id==tree3.id}" ng-repeat="tree3 in treeList | filter:{pid:tree2.id}:true"><em ng-click="selectTree3(tree3)"><i class="iconfont icon-house"></i> {{tree3.name}}</em></li></ul></li></ul></li></ul></div>'),e.put("tpl/uploader.html",'<div class="uploader-wrap"><div class="uploader-list"><div class="file" ng-class="{finished:file.status==\'finished\',error:file.status==\'error\'}" ng-repeat="file in fileList">\' +<div class="img" style="background-image: url({{file.imgSrc}})"></div><div class="progress-mask" style="height:{{file.progress}}%"></div><div class="del" ng-click="delFile(file)"><i class="iconfont icon-delete"></i></div><div class="text"><span class="status">{{file.text}}</span><i>{{file.progress}}%</i></div></div><div class="file file-upload uploadBtn"><i class="iconfont icon-plus"></i></div></div></div>')}])}()}),!function(){var e=document.getElementsByTagName("script"),t=e[e.length-1];require.dir=t.src.match(/[^?#]*\//)[0]}(),require.config({baseUrl:require.dir+"modules",paths:{jQuery:"../libs/jquery.min",angular:"../libs/angular"},shim:{jQuery:{exports:"jQuery"},angular:{deps:["jQuery"],exports:"angular"}},urlArgs:""}),define("manageApp.main",["main/init","main/services","main/controllers","main/directives","main/filters"]),define("manageApp.modal",["modal/init","modal/services","modal/directives"]),define("manageApp.upload",["upload/init","upload/directives"]),define("manageApp",["angular","manageApp.template","manageApp.modal","manageApp.main","manageApp.upload"],function(){return angular.module("manageApp",["ngRoute","manageApp.template","manageApp.modal","manageApp.main","manageApp.upload"])}),require(["manageApp"],function(e){e.config(["$routeProvider",function(e){e.when("/:page*",{templateUrl:function(e){var t=(Config.viewsDir||"")+e.page;delete e.page;var a=$.param(e);return a?t+"?"+a:t},resolve:{load:function(){}}}).otherwise({redirectTo:Config.indexPage})}]),angular.bootstrap(document,["manageApp"])});