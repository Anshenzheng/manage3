/**
 * Manage System v3.0 | haovei@qq.com
 */
define("main/controllers",["main/init"],function(){function e(e){e.mainStatus={navFold:document.body.clientWidth<1500,navigation:"",msgBubble:0},e.mainConfig=window.Config||{},e.pageTo=function(e){window.location.assign(e)},e.mainConfig.getMainInfo&&$.getJSON(e.mainConfig.getMainInfo,function(t){200==t.code&&angular.extend(e.mainStatus,t.data)}).complete(function(){e.$digest()}),$(document).on("click",".top-nav-wrap .backBtn",function(){window.history.back()})}function t(){}function a(e){}function n(e,t){t.closeAll()}e.$inject=["$scope"],a.$inject=["$scope"],n.$inject=["$scope","modal"],angular.module("manageApp.main").controller("mainCtrl",e).controller("oneCtrl",t).controller("sideNav",a).controller("pageCtrl",n)}),define("main/directives",["main/init"],function(){function ngView(e,t,a){return{restrict:"A",priority:-500,link:function(n,i){t.remove(e.current.loadedTemplateUrl),n.mainStatus.pageParams=a}}}function convertToDate(e){var t=e("date");return{require:"ngModel",link:function(e,a,n,i){var o=n.convertToDate?n.convertToDate:"yyyy-MM-dd";i.$parsers.push(function(e){return t(e,o)}),i.$formatters.push(function(){return new Date(i.$modelValue)})}}}function convertToNumber(){return{require:"ngModel",link:function(e,t,a,n){n.$parsers.push(function(e){return parseInt(e,10)}),n.$formatters.push(function(e){return""+e})}}}function detailsInfo(e){return{restrict:"AE",scope:!0,transclude:!0,link:function(t,a,n,i,o){function l(a){t.isLoading=!0,e(n.detailsInfo,a).then(function(e){var a=e[0];t.isLoading=!1,t.detailsHandler?t.details=t.detailsHandler(a):t.details=a})["catch"](function(){t.isLoading=!1})}t.isLoading=!1,o(t,function(e){a.append(e)}),t.detailsHandler=t.$eval(n.detailsHandler),n.detailsParams?0==n.detailsParams.indexOf("{")?n.$observe("detailsParams",function(e){l(t.$eval(e))}):t.$watch(n.detailsParams,function(e){l(e)},!0):l({})}}}function formValidator(e,t){return{restrict:"A",scope:!0,link:function(a,n,i){var o=a.formStatus={submitted:!1,submitting:!1,submitInfo:""},l=angular.element(n)[0],r=(a.$eval(i.name),a.ngDialogData);a.formData=angular.extend({},a.formData),a.$watch(i.source,function(e){e&&angular.isObject(e)&&angular.extend(a.formData,e)}),a.reset=function(){l.reset()},n.on("submit",function(n){n.preventDefault(),o.submitting=!0,e(i.action,a.formData).then(function(e){var n=e[0];o.submitting=!1,o.submitInfo="",angular.isFunction(a.submitCallBack)?a.submitCallBack.call(a,r,n):n&&n.url&&window.location.assign(n.url),angular.isDefined(i.autoCloseDialog)&&t.close()})["catch"](function(e){o.submitting=!1,o.submitInfo=e||"提交失败。",angular.isFunction(a.submitCallBack)&&a.submitCallBack.call(a,r,"")})})}}}function tableList(e,t,a,n){return{restrict:"AE",scope:{listParams:"=?",listSelected:"=?",listSource:"=?"},transclude:!0,require:"?^ngModel",link:function(i,o,l,r,s){function c(t){return l.listSource?(i.tbodyList=i.listSource,void(t&&t())):(g.isLoading=!0,void e(i.listData,angular.merge({},p,{page:g.currentPage})).then(function(e){var a=e[1];200==a.code?(a.options&&(g.totalCount=a.options.totalCount||g.totalCount,g.pageSize=a.options.pageSize||g.pageSize,g.totalPage=Math.ceil(g.totalCount/g.pageSize)),a.thead&&(i.theadList=a.thead),a.data&&a.data.length>0?i.tbodyList=a.data:g.isFinished=!0,g.loadFailMsg=a.message):(g.isFinished=!0,g.loadFailMsg=a.message),g.isLoading=!1,n(u),t&&t()})["catch"](function(){g.isLoading=!1,g.loadFailMsg="加载出错",t&&t()}))}function d(){var e=[];i.listSelected.length=0,$(".selectOne:checked",o).each(function(){e.push(this.value)}),[].unshift.apply(i.listSelected,e);var t=[];angular.forEach(i.tbodyList,function(e){angular.forEach(i.listSelected,function(a){e.id==a&&t.push(e)})}),r&&r.$setViewValue(t)}function u(){$(".selectOne",o).on("click",function(e){e.stopPropagation();var t=$(".selectOne",o).length,a=$(".selectOne:checked",o).length;a>0&&t>a?$(".selectAll",o).prop("checked",!1).get(0).indeterminate=!0:t==a?$(".selectAll",o).prop("checked",!0).get(0).indeterminate=!1:$(".selectAll",o).prop("checked",!1).get(0).indeterminate=!1,d(),i.$apply()})}var g={currentPage:1,totalCount:0,pageSize:10,totalPage:1,isFinished:!1,isLoading:!1};i.parent=i.$parent,i.status=g,i.listData=l.listData,i.theadList=angular.fromJson(l.listThead),i.tbodyList=[],i.getListData=c,angular.isDefined(i.listParams)||(i.listParams={}),angular.isDefined(i.listSelected)||(i.listSelected=[]),i.delSelected=function(t){a("确定删除这些?",function(){e(t,{ids:i.listSelected.join(",")}).then(function(){i.$broadcast("reloadList")})["catch"](function(e){alert(e||"删除错误")})})},i.deleteThis=function(t){var n=this.tr;a("确定删除?",function(){e(t,{id:n.id}).then(function(){i.tbodyList.splice(i.tbodyList.indexOf(n),1),0==i.tbodyList.length&&i.$broadcast("reloadList")})["catch"](function(e){alert(e||"删除错误")})})},i.selectThis=function(){var e=this.tr,t=i.tbodyList.indexOf(e),a=o.find("tbody tr");a.removeClass("on").eq(t).addClass("on"),r&&r.$setViewValue(angular.copy(e))},i.changeStatus=function(t,n){var o=this.tr;a(n||"确定?",function(){e(t,{id:o.id}).then(function(e){var t=e[0],a=i.tbodyList.indexOf(o);i.tbodyList[a]=t})["catch"](function(e){alert(e||"请求失败!")})})},i.submitCallBack=function(e,a){t.closeAll(),a&&e?angular.forEach(i.tbodyList,function(t,n){t.id==e.id&&(i.tbodyList[n]=a)}):n(function(){i.$broadcast("reloadList")})};var p={};i.$on("deleteSelected",function(e,t){$(".selectOne[value="+t.id+"]",o).prop("checked",!1);var a=$(".selectOne",o).length,n=$(".selectOne:checked",o).length;n>0&&a>n?$(".selectAll",o).prop("checked",!1).get(0).indeterminate=!0:a==n?$(".selectAll",o).prop("checked",!0).get(0).indeterminate=!1:$(".selectAll",o).prop("checked",!1).get(0).indeterminate=!1;var l=[];i.listSelected.length=0,$(".selectOne:checked",o).each(function(){l.push(this.value)}),[].unshift.apply(i.listSelected,l),d()}),i.$watchCollection("listSource",function(e){e&&c(d)}),i.$watch("listParams",function(){g.currentPage=1,g.isFinished=!1,i.tbodyList=[],p=angular.copy(i.listParams),c(d),$(".selectAll",o).length>0&&($(".selectAll",o).prop("checked",!1).get(0).indeterminate=!1)},!0),i.$on("reloadList",function(){g.currentPage=1,g.isFinished=!1,i.tbodyList=[],p=angular.copy(i.listParams),c(d),$(".selectAll",o).length>0&&($(".selectAll",o).prop("checked",!1).get(0).indeterminate=!1)}),$(o).on("click",".selectAll",function(){this.indeterminate?(this.checked=!1,$(".selectOne",o).prop("checked",!1)):$(".selectOne",o).prop("checked",this.checked),d(),i.$apply()}),s(i,function(e){o.append(e)})}}}function tableCell(){return{restrict:"AE",scope:{row:"="},replace:!0,templateUrl:"tpl/table-cell.html",link:function(e,t,a){e.cells=[],angular.isString(e.row)||angular.isNumber(e.row)?e.cells.push({text:e.row}):angular.isArray(e.row)?angular.forEach(e.row,function(t){angular.isObject(t)?e.cells.push(t):e.cells.push({text:t})}):e.cells.push(e.row)}}}function pagination(){return{restrict:"AE",scope:!0,replace:!0,templateUrl:"tpl/pagination.html",link:function(e,t,a){function n(e,t,a){return{number:e,text:t,active:a}}function i(e,t){var a=[],i=1,r=t,s=angular.isDefined(o)&&t>o;s&&(l?(i=Math.max(e-Math.floor(o/2),1),r=i+o-1,r>t&&(r=t,i=r-o+1)):(i=(Math.ceil(e/o)-1)*o+1,r=Math.min(i+o-1,t)));for(var c=i;r>=c;c++){var d=n(c,c,c===e);a.push(d)}if(s&&!l){if(i>1){var u=n(i-1,"...",!1);a.unshift(u)}if(t>r){var g=n(r+1,"...",!1);a.push(g)}}return a}var o=angular.isDefined(a.maxSize)?e.$parent.$eval(a.maxSize):10,l=angular.isDefined(a.rotate)?e.$parent.$eval(a.rotate):!0;e.start=function(){1!=e.status.currentPage&&(e.status.currentPage=1,e.getListData())},e.prev=function(){e.status.currentPage<=1||(e.status.currentPage--,e.getListData())},e.next=function(){e.status.currentPage>=e.status.totalPage||(e.status.currentPage++,e.getListData())},e.end=function(){e.status.currentPage!=e.status.totalPage&&(e.status.currentPage=e.status.totalPage,e.getListData())},e["goto"]=function(t){e.status.currentPage=t,e.getListData()},e.$watch("status.totalPage",function(){e.pages=i(e.status.currentPage,e.status.totalPage)}),e.$watch("status.currentPage",function(){e.pages=i(e.status.currentPage,e.status.totalPage)})}}}function pagination2(){return{restrict:"AE",scope:!0,replace:!0,templateUrl:"tpl/pagination2.html",link:function(e,t,a){e.start=function(){1!=e.status.currentPage&&(e.status.currentPage=1,e.getListData())},e.prev=function(){e.status.currentPage<=1||(e.status.currentPage--,e.getListData())},e.next=function(){e.status.currentPage>=e.status.totalPage||(e.status.currentPage++,e.getListData())},e.end=function(){e.status.currentPage!=e.status.totalPage&&(e.status.currentPage=e.status.totalPage,e.getListData())}}}}function filterConditions(e){return{restrict:"AE",scope:{},transclude:!0,link:function(t,a,n,i,o){function l(){var e={};angular.forEach(t.filterConditions.list,function(t){e[t.type]=t.id}),t.filterParams=e}t.filterParams={},t.filterConditions={list:[]};var r=t.filterConditions;t.conditionList={},t.selectCondition=function(e,t){t.type=e,r[e]=t,r.list.push(t),l()},t.deleteCondition=function(e){var t=r.list.indexOf(e);r.list.splice(t,1),delete r[e.type],l()},n.filterConditions&&!function(){e(n.filterConditions).then(function(e){var a=e[0];t.conditionList=a})}(),o(t,function(e){a.append(e)})}}}function treeList(e){return{restrict:"AE",scope:{},require:"?^ngModel",templateUrl:"tpl/tree.html",link:function(t,a,n,i){function o(e){for(var t={},a=[],n=0;0!=e.length;){if("0"==e[n].pid)a.push({id:e[n].id,name:e[n].name,nodes:[]}),t[e[n].id]=[a.length-1],e.splice(n,1),n--;else{var i=t[e[n].pid];if(void 0!=i){for(var o=a[i[0]],l=1;l<i.length;l++)o=o.nodes[i[l]];var r=angular.copy(e[n]);r.nodes=[],o.nodes.push(r),t[e[n].id]=i.concat([o.nodes.length-1]),e.splice(n,1),n--}}n++,n>e.length-1&&(n=0)}return a}function l(){t.status.isLoading=!0,e(n.treeList).then(function(e){var a=e[0];t.treeList=o(a),t.status.isLoading=!1})["catch"](function(){t.status.isLoading=!1})}t.status={},t.treeList=[],t.curTree={},t.status.isLoading=!0,t.selectTree=function(e,t){var n=a.find("li"),o=$(t.currentTarget),l=angular.copy(e);0==l.nodes.length?(n.removeClass("on"),o.parent("li").addClass("on"),i&&i.$setViewValue(l)):(n.removeClass("fold"),o.parents("li").addClass("fold"))},n.$observe("treeList",l)}}}function treeList2(e,t,a){return{restrict:"AE",require:"?^ngModel",link:function(a,n,i,o){function l(e){for(var t={},a=[],n=0;0!=e.length;){if("0"==e[n].pid)a.push({id:e[n].id,name:e[n].name,nodes:[]}),t[e[n].id]=[a.length-1],e.splice(n,1),n--;else{var i=t[e[n].pid];if(void 0!=i){for(var o=a[i[0]],l=1;l<i.length;l++)o=o.nodes[i[l]];var r=angular.copy(e[n]);r.nodes=[],o.nodes.push(r),t[e[n].id]=i.concat([o.nodes.length-1]),e.splice(n,1),n--}}n++,n>e.length-1&&(n=0)}return a}function r(){a.status.isLoading=!0,e(i.treeList2).then(function(e){var t=e[0];a.treeList=l(t),a.status.isLoading=!1})["catch"](function(){a.status.isLoading=!1})}a.status={},a.treeList=[],a.curTree={},a.status.isLoading=!0,a.selectTree=function(e,t){var a=n.find("li"),i=$(t.currentTarget),l=angular.copy(e);0==l.nodes.length?(a.removeClass("on"),i.parent("li").addClass("on"),o&&o.$setViewValue(l)):(a.removeClass("fold"),i.parents("li").addClass("fold"))},a.extendTree=function(e){e.preventDefault(),e.stopPropagation();var t=$(e.currentTarget);t.hasClass("on")?(t.removeClass("on"),t.parent().next().hide()):(t.addClass("on"),t.parent().next().show())},i.$observe("treeList2",r),a.submitCallBack=function(e,a){t.closeAll(),r()}}}}function navList(e){return{restrict:"AE",scope:!0,transclude:!0,require:"?^ngModel",link:function(t,a,n,i,o){function l(a){return n.listSource?(t.tbodyList=t.listSource,void(a&&a())):(r.isLoading=!0,void e(n.navList).then(function(e){var a=e[0];t.isLoading=!1,t.listData=a.data,t.select(t.listData[0])})["catch"](function(){t.isLoading=!1}))}o(t,function(e){a.append(e)});var r={isLoading:!0};t.status=r,t.currentSelect={};t.select=function(e){t.currentSelect=e,i&&i.$setViewValue(e)},l()}}}function selectAsync(e){return{restrict:"A",scope:{},require:"?^ngModel",link:function(t,a,n,i){e(n.selectAsync).then(function(e){for(var t=e[0],n='<option value="">请选择</option>',o=t.length,l=0;o>l;l++)n+='<option value="'+t[l].value+'">'+t[l].text+"</option>";a.html(n),i&&a.val(i.$viewValue)})}}}function relativeSelect(e,t){return{restrict:"A",scope:{},require:"?^ngModel",link:function(a,n,i,o){function l(){var e={};e[n[0].name]=n.val(),$(s).trigger("update",e)}function r(t){e(c,t).then(function(e){for(var t=e[0],a=d?"":'<option value="">请选择</option>',i=t.length,r="",s=0;i>s;s++)(t[s].selected||d&&0==s)&&(r=t[s].value),a+="<option "+(0===t[s].enabled?' class="text-muted"':"")+' value="'+t[s].value+'">'+t[s].text+"</option>";n.html(a),n.val(r),o&&o.$setViewValue(r),l()})}var s=i.relativeTo,c=i.relativeSelect,d=angular.isDefined(i.selectFirst),u=angular.isDefined(i.relativeInitload);n.on("change",l),n.on("update",function(e,t){r(t)}),u&&t(l)}}}function eChart(requestData,dialogChart){return{restrict:"A",scope:{clickToUrl:"@",clickToDialog:"@",chartParams:"="},require:"?^ngModel",link:function($scope,$element,$attrs,ngModel){$scope.isLoading=!1,require(["echarts"],function(echarts){function reSize(){myChart.resize()}function loadChart(_url,_params){$scope.isLoading||($scope.isLoading=!0,myChart.showLoading(),requestData(_url,_params).then(function(results){var _data=results[0];myChart.hideLoading(),_data.polar?_data.tooltip.formatter=function(e){var t=e[0].name;return angular.forEach(e,function(e){t+="<br>"+e.seriesName+": "+e.data}),t}:_data.tooltip.formatter&&0==_data.tooltip.formatter.indexOf("function")&&(_data.tooltip.formatter=eval("("+_data.tooltip.formatter+")")),myChart.setOption(_data),$scope.isLoading=!1})["catch"](function(e){$scope.isLoading=!1,myChart.hideLoading()}))}var myChart=echarts.init($element[0]);$(window).on("resize",reSize),$scope.$on("$destroy",function(){$(window).off("resize",reSize),myChart.dispose()}),myChart.on("click",function(e){ngModel&&ngModel.$setViewValue(e.data),$scope.clickToUrl?window.location.assign($scope.clickToUrl):$scope.clickToDialog&&dialogChart($scope.$parent.mainConfig.viewsDir+$scope.clickToDialog)}),angular.isDefined($attrs.chartParams)?$scope.$watch("chartParams",function(e){loadChart($attrs.chart,e)},!0):($attrs.$observe("chart",function(e){loadChart($attrs.chart)}),loadChart($attrs.chart))})}}}function angucomplete(e,t,a,n){return{restrict:"EA",scope:{placeholder:"@",selectedItem:"=?",url:"@",titleField:"@",descriptionField:"@",searchFields:"@",matchClass:"@"},require:"?^ngModel",templateUrl:"tpl/autocomplete.html",link:function(e,i,o,l){e.lastSearchTerm=null,e.currentIndex=null,e.justChanged=!1,e.searchTimer=null,e.hideTimer=null,e.searching=!1,e.pause=300,e.minLength=1,e.searchStr=null;var r=function(t,a){return t.length>=e.minLength&&t!=a};e.processResults=function(t,n){if(t&&t.length>0){e.results=[];var i=[];e.titleField&&""!=e.titleField&&(i=e.titleField.split(","));for(var o=0;o<t.length;o++){for(var l=[],r=0;r<i.length;r++)l.push(t[o][i[r]]);var s="";e.descriptionField&&(s=t[o][e.descriptionField]);var c=l.join(" ");if(e.matchClass){var d=new RegExp(n,"i"),u=c.match(d)[0];c=a.trustAsHtml(c.replace(d,'<span class="'+e.matchClass+'">'+u+"</span>"))}var g={id:t[o].id,title:c,description:s,originalObject:t[o]};e.results[e.results.length]=g}}else e.results=[]},e.searchTimerComplete=function(a){if(a.length>=e.minLength)if(e.localData){for(var n=e.searchFields.split(","),i=[],o=0;o<e.localData.length;o++){for(var l=!1,r=0;r<n.length;r++)l=l||"string"==typeof e.localData[o][n[r]]&&"string"==typeof a&&e.localData[o][n[r]].toLowerCase().indexOf(a.toLowerCase())>=0;l&&(i[i.length]=e.localData[o])}e.searching=!1,e.processResults(i,a)}else t(e.url,{q:a}).then(function(t){var n=t[0];e.searching=!1,e.processResults(n,a)})["catch"](function(t){e.searching=!1,console.error(t)})},e.hideResults=function(){e.hideTimer=n(function(){e.showDropdown=!1},e.pause)},e.resetHideResults=function(){e.hideTimer&&n.cancel(e.hideTimer)},e.hoverRow=function(t){e.currentIndex=t},e.keyPressed=function(t){38!=t.which&&40!=t.which&&13!=t.which?e.searchStr&&""!=e.searchStr?r(e.searchStr,e.lastSearchTerm)&&(e.lastSearchTerm=e.searchStr,e.showDropdown=!0,e.currentIndex=-1,e.results=[],e.searchTimer&&n.cancel(e.searchTimer),e.searching=!0,e.searchTimer=n(function(){e.searchTimerComplete(e.searchStr)},e.pause)):(e.showDropdown=!1,e.lastSearchTerm=null):t.preventDefault()},e.selectResult=function(t){e.matchClass&&(t.title=t.title.toString().replace(/(<([^>]+)>)/gi,"")),e.searchStr=e.lastSearchTerm=t.title,e.selectedItem=t,e.showDropdown=!1,e.results=[],l&&l.$setViewValue(t.id)};var s=i.find("input");s.on("keyup",e.keyPressed),i.on("keyup",function(t){40===t.which?(e.results&&e.currentIndex+1<e.results.length&&(e.currentIndex++,e.$apply(),t.preventDefault,t.stopPropagation()),e.$apply()):38==t.which?e.currentIndex>=1&&(e.currentIndex--,e.$apply(),t.preventDefault,t.stopPropagation()):13==t.which?e.results&&e.currentIndex>=0&&e.currentIndex<e.results.length?(e.selectResult(e.results[e.currentIndex]),e.$apply(),t.preventDefault,t.stopPropagation()):(e.results=[],e.$apply(),t.preventDefault,t.stopPropagation()):27==t.which?(e.results=[],e.showDropdown=!1,e.$apply()):8==t.which&&(e.selectedItem=null,e.$apply())})}}}function checkboxGroup(){return{restrict:"A",scope:{checkboxGroup:"="},link:function(e,t,a){angular.isArray(e.checkboxGroup)||(e.checkboxGroup=[]),t.on("click",function(){var n=e.checkboxGroup.indexOf(a.value);t[0].checked?-1===n&&e.checkboxGroup.push(a.value):-1!==n&&e.checkboxGroup.splice(n,1),e.$apply()}),e.$watchCollection("checkboxGroup",function(n){n&&-1!==e.checkboxGroup.indexOf(a.value)&&(t[0].checked=!0)})}}}function chosen(e,t){return{restrict:"A",scope:{chosen:"="},require:"?^ngModel",link:function(a,n,i,o){var l={no_results_text:"没有找到",display_selected_options:!1};i.width&&(l.width=i.width),require(["chosen"],function(){function r(e){var t=$("option:selected",n).not(":empty").clone().attr("selected",!0);c&&c.abort(),c=$.ajax({url:i.selectSource,type:"post",data:{q:e},dataType:"json",success:function(a){if(200==a.code){for(var i="",l=a.data.length,r=angular.isArray(o.$viewValue)?o.$viewValue:[o.$viewValue],s=0;l>s;s++)-1==r.indexOf(a.data[s].value)&&(i+='<option value="'+a.data[s].value+'">'+a.data[s].text+"</option>");n.html(i).prepend(t),n.trigger("chosen:updated");var c=$.Event("keydown");c.which=39,u.val(e).trigger(c),a.data.length>0?d.find(".no-results").hide():d.find(".no-results").show()}},complete:function(){a.$digest()}})}function s(e){var n=$(this);if("paste"===e.type&&n.is(":not(:focus)")||e.keyCode&&(9===e.keyCode||13===e.keyCode||16===e.keyCode||17===e.keyCode||18===e.keyCode||19===e.keyCode||20===e.keyCode||27===e.keyCode||33===e.keyCode||34===e.keyCode||35===e.keyCode||36===e.keyCode||37===e.keyCode||38===e.keyCode||39===e.keyCode||40===e.keyCode||44===e.keyCode||45===e.keyCode||144===e.keyCode||145===e.keyCode||91===e.keyCode||93===e.keyCode||224===e.keyCode||e.keyCode>=112&&e.keyCode<=123))return!1;if(p&&32!=e.keyCode&&(e.keyCode<48||e.keyCode>57))return!1;d.find(".no-results").hide();var i=$.trim(n.val());return i||g!=i?(g=i,f=!0,a.searchTimer&&t.cancel(a.searchTimer),void(a.searchTimer=t(function(){f=!1,r(i)},600))):!1}if(i.selectSource)if(angular.isDefined(i.chosenAjax)){n.chosen(l);var c,d=n.next(),u=$("input",d),g="",p=!1,f=!1;$(".chosen-search > input, .chosen-choices .search-field input",d).on("keyup",s).on("paste",function(e){var t=this;setTimeout(function(){s.call(t,e)},500)}).on("keydown",function(e){p=229==e.keyCode?!0:!1})}else e(i.selectSource).then(function(e){for(var t=e[0],i="",r=t.length,s=angular.isArray(o.$viewValue)?o.$viewValue:[o.$viewValue],c=0;r>c;c++)i+='<option value="'+t[c].value+'"'+(s.indexOf(t[c].value)>-1?"selected":"")+">"+t[c].text+"</option>";n.html(i),n.chosen(a.chosen||l)});else n.chosen(a.chosen||l)})}}}function formItem(e){return{restrict:"AE",scope:!0,replace:!0,link:function(t,a,n){var i=t.$eval(n.src),o="";switch(i.type){case"text":o='<input type="'+i.type+'" name="'+i.key+'" ng-init="formData[\''+i.key+"']='"+(i.value||"")+"'\" ng-model=\"formData['"+i.key+'\']" class="ipt" placeholder="'+i.placeholder+'" />';break;case"date":o='<input type="'+i.type+'" name="'+i.key+'" ng-init="formData[\''+i.key+"']='"+(i.value||"")+"'\" ng-model=\"formData['"+i.key+'\']" class="ipt" placeholder="'+i.placeholder+'" convert-to-date/>';break;case"checkbox":o='<div class="form-ctrl" ng-init="formData[\''+i.key+"']=['"+(i.value||"")+"']\">",angular.forEach(i.options,function(e){o+='<label class="label"><input type="'+i.type+'" name="'+i.key+'" checkbox-group="formData[\''+i.key+'\']"  value="'+e+'" /> '+e+"</label>"}),o+="</div>";break;case"radio":o='<div class="form-ctrl" ng-init="formData[\''+i.key+"']='"+(i.value||"")+"'\">",angular.forEach(i.options,function(e){o+='<label class="label"><input type="'+i.type+'" name="'+i.key+'" ng-model="formData[\''+i.key+'\']"  value="'+e+'" /> '+e+"</label>"}),o+="</div>";break;case"select":o='<select class="select select-w" name="'+i.key+'" ng-init="formData[\''+i.key+"']='"+(i.value||"")+"'\" ng-model=\"formData['"+i.key+"']\"  >",o+='<option value="" >请选择</option>',angular.forEach(i.options,function(e){o+='<option value="'+e+'" >'+e+"</option>"}),o+="</select>";break;case"textarea":o='<textarea name="'+i.key+'" ng-init="formData[\''+i.key+"']='"+(i.value||"")+"'\" ng-model=\"formData['"+i.key+'\']"  class="textarea" placeholder="'+i.placeholder+'"></textarea>'}a.append(e(o)(t))}}}function customConfig(e){return{restrict:"AE",scope:!0,transclude:!0,require:"?^ngModel",link:function(t,a,n,i,o){e(function(){i&&(t.dataList=i.$viewValue||[])}),t.$watchCollection("dataList",function(e){e&&i&&i.$setViewValue(e)}),t.addRow=function(){t.dataList.push({})},t.delRow=function(e){t.dataList.splice(e,1)},o(t,function(e){a.append(e)})}}}ngView.$inject=["$route","$templateCache","$routeParams"],convertToDate.$inject=["$filter"],convertToNumber.$inject=[],detailsInfo.$inject=["requestData"],formValidator.$inject=["requestData","modal"],tableList.$inject=["requestData","modal","dialogConfirm","$timeout"],filterConditions.$inject=["requestData"],treeList.$inject=["requestData"],treeList2.$inject=["requestData","modal","$timeout"],navList.$inject=["requestData"],selectAsync.$inject=["requestData"],relativeSelect.$inject=["requestData","$timeout"],eChart.$inject=["requestData","dialogChart"],angucomplete.$inject=["$parse","requestData","$sce","$timeout"],chosen.$inject=["requestData","$timeout"],formItem.$inject=["$compile"],customConfig.$inject=["$timeout"],angular.module("manageApp.main").directive("ngView",ngView).directive("convertToDate",convertToDate).directive("convertToNumber",convertToNumber).directive("detailsInfo",detailsInfo).directive("formValidator",formValidator).directive("tableList",tableList).directive("tableCell",tableCell).directive("pagination",pagination).directive("pagination2",pagination2).directive("filterConditions",filterConditions).directive("treeList",treeList).directive("treeList2",treeList2).directive("navList",navList).directive("selectAsync",selectAsync).directive("relativeSelect",relativeSelect).directive("chart",eChart).directive("angucomplete",angucomplete).directive("checkboxGroup",checkboxGroup).directive("chosen",chosen).directive("formItem",formItem).directive("customConfig",customConfig)}),define("main/filters",["main/init"],function(){angular.module("manageApp.main")}),define("main/init",["angular"],function(){angular.module("manageApp.main",[])}),define("main/services",["main/init"],function(){function e(e,t){return{response:function(e){return"string"==typeof e.data&&/^<!DOCTYPE html>/.test(e.data)?(window.location.assign(e.config.url),e):e}}}function t(e,t,a){return function(n,i){var o=e.defer();return t({method:"POST",url:n,data:i||{},transformRequest:function(e){return a(e)},headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"}}).success(function(e,t,a,n){200==t&&200==e.code?o.resolve([e.data,e]):o.reject(e.msg||"出错了")}).error(function(){o.reject("提交失败!")}),o.promise}}function a(e,t){return function(a,n){var i=e.$new(!1);i.confirmText=a||"确定删除?",t.openConfirm({template:"tpl/dialog-confirm.html",scope:i}).then(n)}}function n(e,t){return function(a,n){var i=e.$new(!1);i.content=a,t.openConfirm({template:"tpl/dialog-center.html",scope:i}).then(n)}}function i(e,t,a){return function(a){var n=e.$new(!1),i={},o=a.split("?");o[1]&&angular.forEach(o[1].split("&"),function(e){var t=e.split("=");i[t[0]]=t[1]}),n.url=a,n.urlParams=i,t.open({template:"tpl/dialog-center.html",scope:n})}}e.$inject=["$q","$location"],t.$inject=["$q","$http","$httpParamSerializer"],a.$inject=["$rootScope","modal"],n.$inject=["$rootScope","modal"],i.$inject=["$rootScope","modal","$http"],angular.module("manageApp.main").factory("redirectInterceptor",e).service("requestData",t).service("dialogConfirm",a).service("dialog",n).service("dialogChart",i).config(["$httpProvider",function(e){e.interceptors.push("redirectInterceptor")}])}),define("modal/directives",["modal/init"],function(){function e(e){return{restrict:"A",scope:{modalScope:"="},link:function(t,a,n){a.on("click",function(a){a.preventDefault();var i=angular.isDefined(t.modalScope)?t.modalScope:"noScope";angular.isDefined(n.ngDialogClosePrevious)&&e.close(n.ngDialogClosePrevious);var o=e.getDefaults();e.open({template:n.ngDialog,className:n.ngDialogClass||o.className,controller:n.ngDialogController,controllerAs:n.ngDialogControllerAs,bindToController:n.ngDialogBindToController,scope:i,data:n.ngDialogData,showClose:"false"===n.ngDialogShowClose?!1:"true"===n.ngDialogShowClose?!0:o.showClose,closeByDocument:"false"===n.ngDialogCloseByDocument?!1:"true"===n.ngDialogCloseByDocument?!0:o.closeByDocument,closeByEscape:"false"===n.ngDialogCloseByEscape?!1:"true"===n.ngDialogCloseByEscape?!0:o.closeByEscape,overlay:"false"===n.ngDialogOverlay?!1:"true"===n.ngDialogOverlay?!0:o.overlay,preCloseCallback:n.ngDialogPreCloseCallback||o.preCloseCallback})})}}}function t(e){return{restrict:"A",scope:{modalScope:"="},link:function(t,a,n){var i=n.modalRight||"50%";a.on("click",function(a){a.preventDefault(),e.closeAll(),e.open({template:n.modalUrl,className:"ngdialog-theme-right",cache:!1,trapFocus:!0,overlay:"true"==n.modalOverlay,data:n.modalData||t.modalScope.tr,scope:t.modalScope,controller:["$scope","$element",function(e,t){$(".ngdialog-content",t).width(i)}]})})}}}function a(e){return{restrict:"A",scope:{modalScope:"="},link:function(t,a,n){var i=n.modalCenter||"50%";a.on("click",function(a){a.preventDefault(),e.open({template:n.modalUrl,cache:!1,trapFocus:!1,data:n.modalData||t.modalScope.tr,scope:t.modalScope,controller:["$scope","$element",function(e,t){$(".ngdialog-content",t).width(i)}]})})}}}e.$inject=["modal"],t.$inject=["modal"],a.$inject=["modal"],angular.module("manageApp.modal").directive("modal",e).directive("modalRight",t).directive("modalCenter",a)}),define("modal/init",["angular"],function(){angular.module("manageApp.modal",[])}),define("modal/services",["modal/init"],function(){"use strict";var e=angular.module("manageApp.modal"),t=angular.element,a=angular.isDefined,n=(document.body||document.documentElement).style,i=a(n.animation)||a(n.WebkitAnimation)||a(n.MozAnimation)||a(n.MsAnimation)||a(n.OAnimation),o="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",l="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",r="ngdialog-disabled-animation",s={html:!1,body:!1},c={},d=[],u=!1,g=!1;e.provider("modal",function(){var e=this.defaults={className:"ngdialog-theme-default",disableAnimation:!1,plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0,trapFocus:!0,preserveFocus:!0,ariaAuto:!0,ariaRole:null,ariaLabelledById:null,ariaLabelledBySelector:null,ariaDescribedById:null,ariaDescribedBySelector:null};this.setForceHtmlReload=function(e){s.html=e||!1},this.setForceBodyReload=function(e){s.body=e||!1},this.setDefaults=function(t){angular.extend(e,t)},this.setOpenOnePerName=function(e){g=e||!1};var a,n=0,p=0,f={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function(m,h,v,y,b,$,D,C,k,w){var L=[],x={onDocumentKeydown:function(e){27===e.keyCode&&A.close("$escape")},activate:function(e){var t=e.data("$ngDialogOptions");t.trapFocus&&(e.on("keydown",x.onTrapFocusKeydown),L.body.on("keydown",x.onTrapFocusKeydown))},deactivate:function(e){e.off("keydown",x.onTrapFocusKeydown),L.body.off("keydown",x.onTrapFocusKeydown)},deactivateAll:function(e){angular.forEach(e,function(e){var t=angular.element(e);x.deactivate(t)})},setBodyPadding:function(e){var t=parseInt(L.body.css("padding-right")||0,10);L.body.css("padding-right",t+e+"px"),L.body.data("ng-dialog-original-padding",t),$.$broadcast("ngDialog.setPadding",e)},resetBodyPadding:function(){var e=L.body.data("ng-dialog-original-padding");e?L.body.css("padding-right",e+"px"):L.body.css("padding-right",""),$.$broadcast("ngDialog.setPadding",0)},performCloseDialog:function(e,t){var n=e.data("$ngDialogOptions"),l=e.attr("id"),r=c[l];if(r){if("undefined"!=typeof C.Hammer){var s=r.hammerTime;s.off("tap",a),s.destroy&&s.destroy(),delete r.hammerTime}else e.unbind("click");1===p&&L.body.unbind("keydown",x.onDocumentKeydown),e.hasClass("ngdialog-closing")||(p-=1);var g=e.data("$ngDialogPreviousFocus");g&&g.focus&&g.focus(),$.$broadcast("ngDialog.closing",e,t),p=0>p?0:p,i&&!n.disableAnimation?(r.$destroy(),e.unbind(o).bind(o,function(){x.closeDialogElement(e,t)}).addClass("ngdialog-closing")):(r.$destroy(),x.closeDialogElement(e,t)),f[l]&&(f[l].resolve({id:l,value:t,$dialog:e,remainingDialogs:p}),delete f[l]),c[l]&&delete c[l],d.splice(d.indexOf(l),1),d.length||(L.body.unbind("keydown",x.onDocumentKeydown),u=!1)}},closeDialogElement:function(e,t){e.remove(),0===p&&(L.html.removeClass("ngdialog-open"),L.body.removeClass("ngdialog-open"),x.resetBodyPadding()),$.$broadcast("ngDialog.closed",e,t)},closeDialog:function(e,t){var a=e.data("$ngDialogPreCloseCallback");if(a&&angular.isFunction(a)){var n=a.call(e,t);angular.isObject(n)?n.closePromise?n.closePromise.then(function(){x.performCloseDialog(e,t)}):n.then(function(){x.performCloseDialog(e,t)},function(){}):n!==!1&&x.performCloseDialog(e,t)}else x.performCloseDialog(e,t)},onTrapFocusKeydown:function(e){var t,a=angular.element(e.currentTarget);if(a.hasClass("ngdialog"))t=a;else if(t=x.getActiveDialog(),null===t)return;var n=9===e.keyCode,i=e.shiftKey===!0;n&&x.handleTab(t,e,i)},handleTab:function(e,t,a){var n=x.getFocusableElements(e);if(0===n.length)return void(document.activeElement&&document.activeElement.blur());var i=document.activeElement,o=Array.prototype.indexOf.call(n,i),l=-1===o,r=0===o,s=o===n.length-1,c=!1;a?(l||r)&&(n[n.length-1].focus(),c=!0):(l||s)&&(n[0].focus(),c=!0),c&&(t.preventDefault(),t.stopPropagation())},autoFocus:function(e){var a=e[0],n=a.querySelector("*[autofocus]");if(null===n||(n.focus(),document.activeElement!==n)){var i=x.getFocusableElements(e);if(i.length>0)return void i[0].focus();var o=x.filterVisibleElements(a.querySelectorAll("h1,h2,h3,h4,h5,h6,p,span"));if(o.length>0){var l=o[0];t(l).attr("tabindex","-1").css("outline","0"),l.focus()}}},getFocusableElements:function(e){var t=e[0],a=t.querySelectorAll(l),n=x.filterTabbableElements(a);return x.filterVisibleElements(n)},filterTabbableElements:function(e){for(var a=[],n=0;n<e.length;n++){var i=e[n];"-1"!==t(i).attr("tabindex")&&a.push(i)}return a},filterVisibleElements:function(e){for(var t=[],a=0;a<e.length;a++){var n=e[a];(n.offsetWidth>0||n.offsetHeight>0)&&t.push(n)}return t},getActiveDialog:function(){var e=document.querySelectorAll(".ngdialog");return 0===e.length?null:t(e[e.length-1])},applyAriaAttributes:function(e,t){if(t.ariaAuto){if(!t.ariaRole){
var a=x.getFocusableElements(e).length>0?"dialog":"alertdialog";t.ariaRole=a}t.ariaLabelledBySelector||(t.ariaLabelledBySelector="h1,h2,h3,h4,h5,h6"),t.ariaDescribedBySelector||(t.ariaDescribedBySelector="article,section,p")}t.ariaRole&&e.attr("role",t.ariaRole),x.applyAriaAttribute(e,"aria-labelledby",t.ariaLabelledById,t.ariaLabelledBySelector),x.applyAriaAttribute(e,"aria-describedby",t.ariaDescribedById,t.ariaDescribedBySelector)},applyAriaAttribute:function(e,a,n,i){if(n&&e.attr(a,n),i){var o=e.attr("id"),l=e[0].querySelector(i);if(!l)return;var r=o+"-"+a;return t(l).attr("id",r),e.attr(a,r),r}},detectUIRouter:function(){try{return angular.module("ui.router"),!0}catch(e){return!1}},getRouterLocationEventName:function(){return x.detectUIRouter()?"$stateChangeSuccess":"$locationChangeSuccess"}},A={__PRIVATE__:x,open:function(i){function o(e,t){return $.$broadcast("ngDialog.templateLoading",e),b.get(e,t||{}).then(function(t){return $.$broadcast("ngDialog.templateLoaded",e),t.data||""})}function l(e){return e?angular.isString(e)&&m.plain?e:"boolean"!=typeof m.cache||m.cache?o(e,{cache:h}):o(e,{cache:!1}):"Empty template"}var s=null;if(i=i||{},!(g&&i.name&&(s=i.name+" dialog",this.isOpen(s)))){var m=angular.copy(e),S=++n;s=s||"ngdialog"+S,d.push(s),angular.extend(m,i);var P;f[s]=P=y.defer();var T;c[s]=T=angular.isObject(m.scope)?m.scope.$new():$.$new();var j,E,q=angular.extend({},m.resolve);return angular.forEach(q,function(e,t){q[t]=angular.isString(e)?w.get(e):w.invoke(e,null,null,t)}),y.all({template:l(m.template||m.templateUrl),locals:y.all(q)}).then(function(e){var n=e.template,i=e.locals;m.showClose&&(n+='<div class="ngdialog-close"></div>');var o=m.overlay?"":" ngdialog-no-overlay";if(j=t('<div id="'+s+'" class="ngdialog'+o+'"></div>'),j.html(m.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content" role="document">'+n+"</div>":'<div class="ngdialog-content" role="document">'+n+"</div>"),j.data("$ngDialogOptions",m),T.ngDialogId=s,m.data&&angular.isString(m.data)){var l=m.data.replace(/^\s*/,"")[0];T.ngDialogData="{"===l||"["===l?angular.fromJson(m.data):new String(m.data),T.dialogData=angular.copy(T.ngDialogData),T.ngDialogData.ngDialogId=s}else m.data&&angular.isObject(m.data)&&(T.ngDialogData=m.data,T.dialogData=angular.copy(T.ngDialogData),T.ngDialogData.ngDialogId=s);if(m.className&&j.addClass(m.className),m.disableAnimation&&j.addClass(r),E=m.appendTo&&angular.isString(m.appendTo)?angular.element(document.querySelector(m.appendTo)):L.body,x.applyAriaAttributes(j,m),m.preCloseCallback){var c;angular.isFunction(m.preCloseCallback)?c=m.preCloseCallback:angular.isString(m.preCloseCallback)&&T&&(angular.isFunction(T[m.preCloseCallback])?c=T[m.preCloseCallback]:T.$parent&&angular.isFunction(T.$parent[m.preCloseCallback])?c=T.$parent[m.preCloseCallback]:$&&angular.isFunction($[m.preCloseCallback])&&(c=$[m.preCloseCallback])),c&&j.data("$ngDialogPreCloseCallback",c)}if(T.closeThisDialog=function(e){x.closeDialog(j,e)},m.controller&&(angular.isString(m.controller)||angular.isArray(m.controller)||angular.isFunction(m.controller))){var d;m.controllerAs&&angular.isString(m.controllerAs)&&(d=m.controllerAs);var g=k(m.controller,angular.extend(i,{$scope:T,$element:j}),!0,d);m.bindToController&&angular.extend(g.instance,{ngDialogId:T.ngDialogId,ngDialogData:T.ngDialogData,closeThisDialog:T.closeThisDialog}),j.data("$ngDialogControllerController",g())}if(D(function(){var e=document.querySelectorAll(".ngdialog");x.deactivateAll(e),v(j)(T);var t=C.innerWidth-L.body.prop("clientWidth");L.html.addClass("ngdialog-open"),L.body.addClass("ngdialog-open");var a=t-(C.innerWidth-L.body.prop("clientWidth"));a>0&&x.setBodyPadding(a),E.append(j),x.activate(j),m.trapFocus&&x.autoFocus(j),m.name?$.$broadcast("ngDialog.opened",{dialog:j,name:m.name}):$.$broadcast("ngDialog.opened",j)}),u||(L.body.bind("keydown",x.onDocumentKeydown),u=!0),m.closeByNavigation){var f=x.getRouterLocationEventName();$.$on(f,function(){x.closeDialog(j)})}if(m.preserveFocus&&j.data("$ngDialogPreviousFocus",document.activeElement),a=function(e){var a=m.closeByDocument?t(e.target).hasClass("ngdialog-overlay"):!1,n=t(e.target).hasClass("ngdialog-close");(a||n)&&A.close(j.attr("id"),n?"$closeButton":"$document")},"undefined"!=typeof C.Hammer){var h=T.hammerTime=C.Hammer(j[0]);h.on("tap",a)}else j.bind("click",a);return p+=1,A}),{id:s,closePromise:P.promise,close:function(e){x.closeDialog(j,e)}}}},openConfirm:function(a){var n=y.defer(),i=angular.copy(e);a=a||{},angular.extend(i,a),i.scope=angular.isObject(i.scope)?i.scope.$new():$.$new(),i.scope.confirm=function(e){n.resolve(e);var a=t(document.getElementById(o.id));x.performCloseDialog(a,e)};var o=A.open(i);return o?(o.closePromise.then(function(e){return e?n.reject(e.value):n.reject()}),n.promise):void 0},isOpen:function(e){var a=t(document.getElementById(e));return a.length>0},close:function(e,a){var n=t(document.getElementById(e));if(n.length)x.closeDialog(n,a);else if("$escape"===e){var i=d[d.length-1];n=t(document.getElementById(i)),n.data("$ngDialogOptions").closeByEscape&&x.closeDialog(n,"$escape")}else A.closeAll(a);return A},closeAll:function(e){for(var a=document.querySelectorAll(".ngdialog"),n=a.length-1;n>=0;n--){var i=a[n];x.closeDialog(t(i),e)}},getOpenDialogs:function(){return d},getDefaults:function(){return e}};return angular.forEach(["html","body"],function(e){if(L[e]=m.find(e),s[e]){var t=x.getRouterLocationEventName();$.$on(t,function(){L[e]=m.find(e)})}}),A}]})}),define("project/controllers",["project/init"],function(){function e(e,t,a){e.formData={},e.typeStudent=function(){a.find("input").eq(1).focus()},e.typeScore=function(n,i,o){13==n.keyCode&&t(i,o).then(function(){e.formData.time=Date.now();var t=a.find("input");t.val("").eq(0).focus()})["catch"](function(e){alert(e||"录入成绩错误")})}}function t(e,t,a){var n=t.find(".selectRecipient");e.formData={},e.formData.recipient=[],e.selectOne=function(t){var i=e.formData.recipient.indexOf(t.id);i>-1?e.formData.recipient.splice(i,1):e.formData.recipient.push(t.id),a(function(){n.trigger("chosen:updated")})},e.selectMultiple=function(t,i){var o=$(i.currentTarget);o.data("selected");angular.forEach(t,function(t){var a=e.formData.recipient.indexOf(t.id);-1==a&&e.formData.recipient.push(t.id)}),a(function(){n.trigger("chosen:updated")})}}e.$inject=["$scope","requestData","$element"],t.$inject=["$scope","$element","$timeout"],angular.module("manageApp.project").controller("importScoreCtrl",e).controller("noticePageCtrl",t)}),define("project/directives",["project/init"],function(){angular.module("manageApp.project")}),define("project/filters",["project/init"],function(){angular.module("manageApp.project")}),define("project/init",["angular"],function(){angular.module("manageApp.project",[])}),define("project/services",["project/init"],function(){angular.module("manageApp.project")}),define("upload/directives",["upload/init"],function(){function e(){return{restrict:"EA",scope:{ngModel:"=",uploadMax:"=?",width:"@",height:"@"},replace:!0,templateUrl:"tpl/uploader.html",link:function(e,t,a){function n(){for(var t=l[0].files,a=0,n=t.length;n>a;a++){if(e.fileList.length>=e.uploadMax)return void alert("超过文件上传数");switch(r){case"*":var i={status:"uploading",file:t[a],progress:0,text:"上传中...",name:t[a].name,data:{}};e.fileList.push(i),e.$digest(),o(i);break;case"image":if(/image/g.test(t[a].type)){var i={status:"uploading",file:t[a],progress:0,text:"上传中...",name:t[a].name,data:{},imgSrc:window.URL.createObjectURL(new Blob([t[a]],{type:t[a].type}))};e.fileList.push(i),e.$digest(),o(i)}else alert("只能上传图片");break;default:if(new RegExp(r).test(t[a].type)){var i={status:"uploading",file:t[a],progress:0,text:"上传中...",data:{}};e.fileList.push(i),e.$digest(),o(i)}else alert("上传格式错误")}}}function i(t){var a=[];angular.forEach(e.fileList,function(n,i){t==n?e.fileList.splice(i,1):a.push(n.data.id)}),e.ngModel=a}function o(t){var n=new XMLHttpRequest,i=new FormData;i.append("fileData",t.file),n.upload.addEventListener("progress",function(a){t.progress=Math.round(100*a.loaded/a.total),e.$digest()},!1),n.addEventListener("load",function(a){var n=angular.fromJson(a.target.responseText);t.progress=100,t.status="finished",t.text="上传成功！",t.data=n.data,e.ngModel.push(n.data.id),e.$apply()},!1),n.addEventListener("loadend",function(a){200!=a.target.status&&(t.status="error",t.text="上传失败！",e.$apply())}),n.open("POST",a.uploader),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(i)}var l=$('<input type="file" multiple/>'),r=a.uploadType||"image";e.fileList=[],e.delFile=i,e.ngModel=e.ngModel||[],e.uploadMax=e.uploadMax||99,e.width=e.width?e.width:"120px",e.height=e.height?e.height:"100px",e.$parent.resetPic=function(){e.ngModel=[],e.fileList=[]};var s=$(".uploadBtn",t);s.on("click",function(){l.trigger("click")}),l.on("change",n)}}}e.$inject=[],angular.module("manageApp.upload").directive("uploader",e)}),define("upload/init",["angular"],function(){angular.module("manageApp.upload",[])}),define("manageApp.template",["angular"],function(){!function(){"use strict";angular.module("manageApp.template",[]).run(["$templateCache",function(e){e.put("tpl/autocomplete.html",'<div class="angucomplete-holder"><input ng-model="searchStr" type="text" placeholder="{{placeholder}}" class="ipt" onmouseup="this.select();" ng-focus="resetHideResults()" ng-blur="hideResults()"><div class="angucomplete-dropdown" ng-if="showDropdown"><div class="angucomplete-searching" ng-show="searching">正在查询...</div><div class="angucomplete-searching" ng-show="!searching && (!results || results.length == 0)">没有结果</div><div class="angucomplete-row" ng-repeat="result in results" ng-mousedown="selectResult(result)" ng-mouseover="hoverRow()" ng-class="{\'angucomplete-selected-row\': $index == currentIndex}"><div class="angucomplete-title" ng-if="matchClass" ng-bind-html="result.title"></div><div class="angucomplete-title" ng-if="!matchClass">{{ result.title }}</div><div ng-if="result.description && result.description != \'\'" class="angucomplete-description">{{result.description}}</div></div></div></div>'),e.put("tpl/config-floor.html",'<table class="table-list"><tbody><tr><td>单元名称</td><td ng-repeat="unit in config.unitList track by $index"><input type="text" class="ipt ipt-s ipt-xshort" ng-model="config.unitList[$index]"></td></tr><tr><td>每层户数</td><td ng-repeat="col in config.unitColList track by $index"><input type="number" class="ipt ipt-s ipt-xshort" min="1" ng-model="config.unitColList[$index]"></td></tr></tbody></table>'),e.put("tpl/custom-config.html",'<table class="table-list"><thead><tr><th width="30"></th><th ng-repeat="th in theadList">{{th}}</th><th></th></tr></thead><tbody><tr class="r" ng-repeat="tr in dataList"><td>{{$trIndex = $index + 1}}</td><td ng-repeat="td in tr track by $index"><input type="text" name="{{inputName[$index]}}" class="ipt ipt-block" ng-model="tr[$index]"></td><td><button type="button" class="btn btn-s btn-orange" ng-click="delRow($index)"><i class="iconfont icon-delete"></i> 删除</button></td></tr></tbody><tfoot><tr><td></td><td colspan="{{theadList.length+1}}"><button type="button" class="btn btn-s btn-primary" ng-click="addRow()"><i class="iconfont icon-plus"></i> 新增</button></td></tr></tfoot></table>'),e.put("tpl/dialog-center.html",'<div class="page-dialog-wrap"><div class="page-dialog-content"><div class="mgb-l"><div ng-include="url"></div></div></div></div>'),e.put("tpl/dialog-confirm.html",'<div class="page-dialog-wrap"><div class="page-dialog-content"><div class="mgb-l">{{confirmText}}</div><div class="text-center pd-v-s"><button type="button" class="btn btn-gray" ng-click="closeThisDialog()">取消</button> <button type="button" class="btn btn-blue" ng-click="confirm()">确定</button></div></div></div>'),e.put("tpl/dialog-tree.html",'<div class="page-dialog-wrap"><div class="page-dialog-title">选择</div><div class="page-dialog-content"><div class="tree-list tree-list-border" tree-list="../data/tree.data" ng-model="selectItem"></div><div class="text-center pd-v-s"><button type="button" class="btn btn-gray" ng-click="closeThisDialog()">取消</button> <button type="button" class="btn btn-blue" ng-click="confirm(selectItem)">确定</button></div></div></div>'),e.put("tpl/pagination.html",'<ul class="pagination" ng-if="status.totalPage>1"><li ng-class="{disabled:status.currentPage==1}"><a ng-click="start()"><span class="iconfont icon-page-start"></span></a></li><li ng-class="{disabled:status.currentPage==1}"><a ng-click="prev()"><span class="iconfont icon-page-prev"></span></a></li><li ng-repeat="page in pages" ng-class="{active:page.active}"><a ng-click="goto(page.number)">{{page.text}}</a></li><li ng-class="{disabled:status.currentPage==status.totalPage}"><a ng-click="next()"><span class="iconfont icon-page-next"></span></a></li><li ng-class="{disabled:status.currentPage==status.totalPage}"><a ng-click="end()"><span class="iconfont icon-page-end"></span></a></li></ul>'),e.put("tpl/pagination2.html",'<ul class="pagination2" ng-if="status.totalPage!=1"><li class="text-muted">{{status.currentPage+"/" + status.totalPage}} 页</li><li><a ng-class="{\'on\':status.currentPage==1}" ng-click="start()"><i class="iconfont icon-page-start"></i></a></li><li><a ng-class="{\'on\':status.currentPage==1}" ng-click="prev()"><i class="iconfont icon-page-prev"></i></a></li><li><a ng-class="{\'on\':status.currentPage==status.totalPage}" ng-click="next()"><i class="iconfont icon-page-next"></i></a></li><li><a ng-class="{\'on\':status.currentPage==status.totalPage}" ng-click="end()"><i class="iconfont icon-page-end"></i></a></li></ul>'),e.put("tpl/table-cell.html",'<span ng-repeat="cell in cells" class="{{cell.css}}">{{cell.text}}</span>'),e.put("tpl/table-list.html",'<div><div class="fr"><pagination status="status"></pagination></div><div ng-transclude=""></div></div><table class="table-list"><thead><tr><th ng-if="listSelected"><input type="checkbox" class="selectAll"></th><th ng-repeat="(hKey,hValue) in theadList">{{hValue}}</th></tr></thead><tbody><tr ng-repeat="tr in tbodyList"><td ng-if="listSelected" class="select-td"><input type="checkbox" class="selectOne" value="{{tr.id}}">{{$index}}</td><td ng-repeat="(hKey,hValue) in theadList"><table-cell row="tr[hKey]"></table-cell></td></tr></tbody></table>'),e.put("tpl/tree.html",'<div class="loader" ng-if="status.isLoading"><div class="loader-inner pacman"><div></div><div></div><div></div><div></div><div></div></div></div><div ng-if="!status.isLoading"><div class="empty-wrap" ng-if="treeList.length==0"><div class="icon"><i class="iconfont icon-empty"></i></div><div>什么也没有</div></div><ul ng-if="treeList.length"><li ng-repeat="tree in treeList"><em ng-click="selectTree(tree,$event)"><i class="iconfont fold-p" ng-if="tree.nodes.length"></i> {{tree.name}}</em><ul ng-if="tree.nodes.length"><li ng-repeat="tree2 in tree.nodes"><em ng-click="selectTree(tree2,$event)"><i class="iconfont fold-p" ng-if="tree2.nodes.length"></i> {{tree2.name}}</em><ul ng-if="tree2.nodes.length"><li ng-repeat="tree3 in tree2.nodes"><em ng-click="selectTree(tree3,$event)"><i class="iconfont icon-house"></i> {{tree3.name}}</em></li></ul></li></ul></li></ul></div>'),e.put("tpl/uploader.html",'<div class="uploader-wrap"><div class="uploader-list"><div class="file" title="{{file.name}}" ng-style="{width:width,height:height}" ng-class="{finished:file.status==\'finished\',error:file.status==\'error\'}" ng-repeat="file in fileList">\' +<div class="img" ng-if="file.imgSrc" style="background-image: url({{file.imgSrc}})"></div><div class="img" ng-if="!file.imgSrc" style="background-size:50%;"></div><div class="progress-mask" style="height:{{file.progress}}%"></div><div class="del" ng-click="delFile(file)"><i class="iconfont icon-delete"></i></div><div class="text"><span class="status">{{file.text}}</span><i>{{file.progress}}%</i></div><div class="name">{{file.name}}</div></div><div class="file file-upload uploadBtn" ng-show="uploadMax>fileList.length" ng-style="{width:width,height:height}"><div class="flex-row flex-middle flex-center" style="height: 100%;"><div class="flex-item-12"><i class="iconfont icon-plus"></i></div></div></div></div></div>')}])}()}),!function(){var e=document.getElementsByTagName("script"),t=e[e.length-1];require.dir=t.src.match(/[^?#]*\//)[0]}(),require.config({baseUrl:require.dir+"modules",paths:{echarts:"../libs/echarts.min",chosen:"../libs/chosen.jquery.min",jQuery:"../libs/jquery.min",angular:"../libs/angular.min"},shim:{jQuery:{exports:"jQuery"},chosen:{deps:["jQuery"]},echarts:{exports:"echarts"},angular:{deps:["jQuery"],exports:"angular"}},urlArgs:""}),define("manageApp.main",["main/init","main/services","main/controllers","main/directives","main/filters"]),define("manageApp.project",["project/init","project/services","project/controllers","project/directives","project/filters"]),define("manageApp.modal",["modal/init","modal/services","modal/directives"]),define("manageApp.upload",["upload/init","upload/directives"]),define("manageApp",["angular","manageApp.template","manageApp.modal","manageApp.main","manageApp.project","manageApp.upload"],function(){return angular.module("manageApp",["ngRoute","manageApp.template","manageApp.modal","manageApp.main","manageApp.project","manageApp.upload"])}),require(["manageApp"],function(e){e.config(["$routeProvider","$templateRequestProvider",function(e,t){window.Config?e.when("/:page*",{templateUrl:function(e){var t=(Config.viewsDir||"")+e.page;delete e.page;var a=$.param(e);return a?t+"?"+a:t},resolve:{load:function(){}}}).otherwise({redirectTo:Config.indexPage}):e.when("/:page*",{templateUrl:function(e){var t=e.page;delete e.page;var a=$.param(e);return a?t+"?"+a:t},resolve:{load:function(){}}}),t.httpOptions({headers:{template:"1"}})}]),angular.bootstrap(document,["manageApp"])});